# rename teams and pitchers
# fill in season
import numpy as np
from collections import defaultdict
file_name = "2024_test_data.csv"
output_file = "preprocess2024_test_1.csv"
team_table = {
'BPH': 0, 
'DPS': 1, 
'ECN': 2, 
'FBW': 3, 
'GKO': 4, 
'GLO': 5, 
'GUT': 6, 
'HAN': 7, 
'HXK': 8, 
'JBM': 9, 
'JEM': 10, 
'KFH': 11, 
'KJP': 12, 
'MOO': 13, 
'MZG': 14, 
'PDF': 15, 
'PJT': 16, 
'QDH': 17, 
'QPO': 18, 
'RAV': 19, 
'RKN': 20, 
'RLJ': 21, 
'SAJ': 22, 
'STC': 23, 
'UPV': 24, 
'VJV': 25, 
'VQC': 26, 
'XFB': 27, 
'YHA': 28, 
'ZQF': 29
}


pitcher_table = {'adamsch01': 0, 
'adlemti01': 1, 
'akinke01': 2, 
'alberan01': 3, 
'alberma01': 4, 
'alcanra01': 5, 
'allarko01': 6, 
'allenlo01': 7, 
'alvarjo02': 8, 
'alzolad01': 9, 
'anderdr02': 10, 
'anderia01': 11, 
'arihako01': 12, 
'ashcrgr01': 13, 
'asheral01': 14, 
'avilape01': 15, 
'barnech01': 16, 
'barrija01': 17, 
'battepe01': 18, 
'baumami01': 19, 
'bedroca01': 20, 
'bellch02': 21, 
'bellobr01': 22, 
'benjawe01': 23, 
'bermujo01': 24, 
'berrijo01': 25, 
'bettial01': 26, 
'biagijo01': 27, 
'bibeeta01': 28, 
'bibenau01': 29, 
'blairaa01': 30, 
'blancro01': 31, 
'blevije01': 32, 
'bolsimi01': 33, 
'bonilli01': 34, 
'borucry01': 35, 
'boscawi01': 36, 
'boshebu01': 37, 
'boydma01': 38, 
'boylejo01': 39, 
'bradlar01': 40, 
'briesbe01': 41, 
'brighje01': 42, 
'britojh01': 43, 
'brookaa01': 44, 
'bubickr01': 45, 
'buehlwa01': 46, 
'bumgama01': 47, 
'burkese01': 48, 
'burrry01': 49, 
'bushky01': 50, 
'butleed01': 51, 
'cainma01': 52, 
'campbpa02': 53, 
'cantijo01': 54, 
'carpery01': 55, 
'carraca01': 56, 
'castehu01': 57, 
'castilu02': 58, 
'cavalca01': 59, 
'ceasedy01': 60, 
'ceccosl01': 61, 
'chaveje01': 62, 
'civalaa01': 63, 
'claseem01': 64, 
'cleavga01': 65, 
'coleaj01': 66, 
'colege01': 67, 
'colemdy01': 68, 
'conlopj01': 69, 
'corbipa01': 70, 
'cosarja01': 71, 
'couloda01': 72, 
'coveydy01': 73, 
'crawfku01': 74, 
'criswco01': 75, 
'cruzfe01': 76, 
'cruzst01': 77, 
'curryxz01': 78, 
'danaca01': 79, 
'darviyu01': 80, 
'davieza02': 81, 
'degroja01': 82, 
'delgara01': 83, 
'delosen01': 84, 
'despaod01': 85, 
'detmere01': 86, 
'devench02': 87, 
'diazda01': 88, 
'diazjh01': 89, 
'dobnara01': 90, 
'dodddy01': 91, 
'dunnju01': 92, 
'duplajo01': 93, 
'effrosc01': 94, 
'eflinza01': 95, 
'eliasro01': 96, 
'ellisch01': 97, 
'ennsdi01': 98, 
'eovalna01': 99, 
'erlinro01': 100, 
'eschja01': 101, 
'farrelu01': 102, 
'feierry01': 103, 
'feldmsc01': 104, 
'felizmi01': 105, 
'feltnry01': 106, 
'fernajo02': 107, 
'festada01': 108, 
'festama01': 109, 
'fiersmi01': 110, 
'flaheja01': 111, 
'flynnbr01': 112, 
'foltymi01': 113, 
'fostema01': 114, 
'francbo01': 115, 
'freelky01': 116, 
'fulmemi01': 117, 
'gallayo01': 118, 
'garcija02': 119, 
'garcilu05': 120, 
'garciro03': 121, 
'gausmke01': 122, 
'gavigsa01': 123, 
'gearrco01': 124, 
'gilmase01': 125, 
'giolilu01': 126, 
'gipsosa01': 127, 
'glasnty01': 128, 
'gonsoto01': 129, 
'gonzame01': 130, 
'gonzavi02': 131, 
'gorema01': 132, 
'goudeas01': 133, 
'gracema02': 134, 
'gratebr01': 135, 
'graveke01': 136, 
'grayjo02': 137, 
'grayjo03': 138, 
'greench03': 139, 
'halldl01': 140, 
'hammeja01': 141, 
'hancoem01': 142, 
'hanifbr01': 143, 
'happja01': 144, 
'hardybl01': 145, 
'harvema01': 146, 
'hatchto01': 147, 
'heanean01': 148, 
'heasljo01': 149, 
'hellije01': 150, 
'hendrky01': 151, 
'hendrli01': 152, 
'henriro01': 153, 
'hergeji01': 154, 
'hernafe02': 155, 
'hoeinbr01': 156, 
'hoffmje02': 157, 
'holdejo02': 158, 
'housead01': 159, 
'howarsa01': 160, 
'hudsoda01': 161, 
'hudsoda02': 162, 
'hunteto02': 163, 
'hutchdr01': 164, 
'irvinja01': 165, 
'iveyty01': 166, 
'jacksed01': 167, 
'jarvibr01': 168, 
'jeffeda01': 169, 
'jeffrje01': 170, 
'jennida01': 171, 
'johnsbr02': 172, 
'johnser04': 173, 
'johnspi01': 174, 
'junisja01': 175, 
'junkja01': 176, 
'juradar01': 177, 
'kauffka01': 178, 
'kellyjo05': 179, 
'kendrky01': 180, 
'kershcl01': 181, 
'keuchda01': 182, 
'kikucyu01': 183, 
'kimkw01': 184, 
'klubeco01': 185, 
'knebeco01': 186, 
'kochma01': 187, 
'kranima01': 188, 
'lackejo01': 189, 
'lambeji01': 190, 
'lambepe01': 191, 
'lauerer01': 192, 
'leiteja01': 193, 
'leonedo01': 194, 
'lestejo01': 195, 
'litteza01': 196, 
'littllu01': 197, 
'livelbe01': 198, 
'llovema01': 199, 
'loaisjo01': 200, 
'lockeje01': 201, 
'lockewa01': 202, 
'lopezpa01': 203, 
'lorenmi01': 204, 
'lucchjo01': 205, 
'manaese01': 206, 
'manoaal01': 207, 
'martefr01': 208, 
'martibr01': 209, 
'matthze01': 210, 
'maydu01': 211, 
'mazurad01': 212, 
'mcallza01': 213, 
'mcgousc01': 214, 
'mcgremi01': 215, 
'mcguide02': 216, 
'megilty01': 217, 
'mejiaje02': 218, 
'melviti01': 219, 
'meyeral01': 220, 
'mileywa01': 221, 
'millebo06': 222, 
'millebr04': 223, 
'millety01': 224, 
'millsal02': 225, 
'mizeca01': 226, 
'moorean02': 227, 
'morejad01': 228, 
'moscojo01': 229, 
'moyaga01': 230, 
'munozro01': 231, 
'murfepe01': 232, 
'myersto01': 233, 
'neideni01': 234, 
'nelsoji02': 235, 
'newcose01': 236, 
'nicolju01': 237, 
'nolasri01': 238, 
'okertst01': 239, 
'olsonre01': 240, 
'ortizlu02': 241, 
'ortizlu03': 242, 
'ortka01': 243, 
'palumjo01': 244, 
'pannoth01': 245, 
'parkebl01': 246, 
'parkemi01': 247, 
'parsowe01': 248, 
'patinlu01': 249, 
'payanpe01': 250, 
'penafe01': 251, 
'perdolu02': 252, 
'perezfr01': 253, 
'perezma02': 254, 
'perezwi01': 255, 
'peterda01': 256, 
'peterdi01': 257, 
'pfaadbr01': 258, 
'phillty01': 259, 
'pomerdr01': 260, 
'poteeco01': 261, 
'priesqu01': 262, 
'pruitau01': 263, 
'quantca01': 264, 
'quintjo01': 265, 
'raganco01': 266, 
'ramirye01': 267, 
'reyesal02': 268, 
'richaga01': 269, 
'robleha01': 270, 
'rodrich01': 271, 
'rodride01': 272, 
'rodried05': 273, 
'rodrije01': 274, 
'rodrira02': 275, 
'romerto01': 276, 
'romose01': 277, 
'rossjo01': 278, 
'rossty01': 279, 
'rucindr01': 280, 
'rutleja01': 281, 
'ryanri01': 282, 
'ryuhy01': 283, 
'sabatc.01': 284, 
'sadleca02': 285, 
'sadzeco01': 286, 
'sanchcr01': 287, 
'sandlni01': 288, 
'sandopa02': 289, 
'sandsco01': 290, 
'sanmare01': 291, 
'sborzjo01': 292, 
'scholje01': 293, 
'scottch01': 294, 
'searsjp01': 295, 
'shephch01': 296, 
'silsech01': 297, 
'simslu01': 298, 
'skaggty01': 299, 
'slegeaa01': 300, 
'smeltde01': 301, 
'smithaj01': 302, 
'smithbu03': 303, 
'smithdr01': 304, 
'soriage01': 305, 
'sorokmi01': 306, 
'sparkgl01': 307, 
'stammcr01': 308, 
'stashco01': 309, 
'staumjo01': 310, 
'straida01': 311, 
'stratch01': 312, 
'stridsp01': 313, 
'stromma01': 314, 
'suarean01': 315, 
'suarejo01': 316, 
'suarera01': 317, 
'suterbr01': 318, 
'swanser01': 319, 
'swarmma01': 320, 
'syndeno01': 321, 
'szaputh01': 322, 
'tarplst01': 323, 
'teherju01': 324, 
'tepesni01': 325, 
'tetreja01': 326, 
'tsengje01': 327, 
'turleni01': 328, 
'ucetaed01': 329, 
'urenajo01': 330, 
'valdefr01': 331, 
'vargace01': 332, 
'vasqura02': 333, 
'ventejo01': 334, 
'verhadr01': 335, 
'verrelo01': 336, 
'vesiaal01': 337, 
'vestwi01': 338, 
'vinceni01': 339, 
'volstch01': 340, 
'vothau01': 341, 
'wainwad01': 342, 
'waldike01': 343, 
'waldrma01': 344, 
'walstbl01': 345, 
'warrewi01': 346, 
'weaveje02': 347, 
'weavelu01': 348, 
'wesneha01': 349, 
'whitemi03': 350, 
'wilkad01': 351, 
'wilsobr02': 352, 
'wittgni01': 353, 
'wolfja01': 354, 
'woobr01': 355, 
'woodal02': 356, 
'worleva01': 357, 
'wrighda04': 358, 
'wrighky01': 359, 
'wrighmi01': 360, 
'wrighst01': 361, 
'yamamjo01': 362, 
'youngch03': 363, 
'zastrro01': 364, 
'zeuchtj01': 365
}


# pitcher = []


# with open(file_name, 
# 'r') as file:
#     id1 = 0
#     file.readline()
#     lines = file.readlines()
#     for l in lines:
#         l = l.strip().split(',')
#         pitcher.append(l[4])
#         pitcher.append(l[5])

# pit = np.unique(np.array(pitcher))
# np.sort(pit)
# i = 0
# for p in pit[1:]:
#     print(f'\'{p}\': {i}, ', end='')
#     i += 1


with open(output_file, 'w') as o_f:
    with open(file_name, 'r') as file:
        id1 = 0
        title = file.readline()
        o_f.writelines(title)
        lines = file.readlines()
        for l in lines:
            l = l.strip().split(',')
            # team_name to id
            l[1] = team_table[l[1]]
            l[2] = team_table[l[2]]
            # pitcher name to id
            if (l[4] != ''): l[4] = pitcher_table[l[4]]
            if (l[5] != ''): l[5] = pitcher_table[l[5]] 
            # fill the year
            if (l[10] == ''): 
                if(l[37] != ''): l[10] = l[37][4:8]
                elif(l[38] != ''): l[10] = l[38][4:8]

            newl = []
            for i in range(len(l)):
                newl.append(str(l[i]))
                newl.append(",")
            newl.pop()
            newl.append("\n")
            o_f.writelines(newl)

        # for line in file:
        #     parts = line.strip().split(',')
        #     for i in len(parts):


# print(tim)
# team = np.unique(np.array(tim))
# np.sort(team)
